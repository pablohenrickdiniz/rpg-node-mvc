var paths=require("../config/paths"),database_config=require(paths("appConfig")).database,mongoose=require("mongoose");module.exports={conn:[],get:function(e){var a=this;if(a.conn[e]==undefined){if(database_config[e]!=undefined){var b=database_config[e];var d=["mongodb://",b.host,":",b.port,"/",b.database].join("");var c=mongoose.createConnection(d,{user:b.user,pass:b.pass,server:b.server,replset:b.replset,db:b.db});console.log("conectando a "+b.database);c.on("connected",function(){console.log(b.database+" conectado!")});c.on("error",function(f){console.log("erro ao conectar com "+b.database+":"+f)});c.on("disconnected",function(){console.log("database "+b.database+" disconectado")});a.conn[e]=c}else{throw new Error("Conexão "+e+" não definida")}}return a.conn[e]},disconnectAll:function(d,c){var a=this;c=c==undefined?Object.keys(a.conn):c;if(c.length>0){var b=c.pop();a.disconnect(b,function(){a.disconnectAll(d,c)})}else{d()}},disconnect:function(b,c){var a=this;if(a.conn[b]!=undefined){a.conn[b].close(function(){delete a.conn[b];c()})}else{c()}}};